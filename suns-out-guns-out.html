<!DOCTYPE html>
<html lang="en">

<head>
	<!-- Required meta tags -->
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	<title>Sun's Out Guns Out Project</title>
	<meta name="description" content="Unity third person shooter game">

	<!-- Bootstrap CSS -->
	<link href="./css/bootstrap.min.css" rel="stylesheet">
	<!-- Font Awesome -->
	<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
	<!-- Prism JS -->
	<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.13.1/styles/atom-one-dark.min.css">
	<!-- Google Font -->
	<link href="https://fonts.googleapis.com/css?family=Raleway:300,400,500,700,900" rel="stylesheet">
	<link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700,900" rel="stylesheet">
	<!-- owl carousel css-->
	<link rel="stylesheet" href="./css/owl.carousel.min.css">
	<link rel="stylesheet" href="./css/owl.theme.default.min.css">
	<!-- magnific-popup CSS -->
	<link rel="stylesheet" href="./css/magnific-popup.css">
	<!-- YouTubePopUp CSS -->
	<link rel="stylesheet" href="./css/bicon.min.css" />
	<link rel="stylesheet" href="./css/YouTubePopUp.css">
	<!-- Animate CSS -->
	<link rel="stylesheet" href="./css/animate.css">
	<!-- custom styles (optional) -->
	<link href="./css/style.css" rel="stylesheet">
	<link href="./css/responsive.css" rel="stylesheet">
</head>

<body>
	<!--Loader-->
	<div id="loader">
		<div id="loading-center">
			<div id="loading-center-absolute">
				<div class="object"></div>
				<div class="object"></div>
				<div class="object"></div>
				<div class="object"></div>
				<div class="object"></div>
				<div class="object"></div>
				<div class="object"></div>
				<div class="object"></div>
				<div class="object"></div>
				<div class="object"></div>
			</div>
		</div>
	</div>
	<!-- Loader end -->
	<!-- ====== Navgition ======  -->
	<nav class="navbar navbar-expand-lg fixed-top">
		<div class="container">
			<!-- Logo -->
			<a class="navbar-brand pt-0 logo" href="#">
				<img src="./img/game-programmer-logo.png" alt="Game Programmer Logo" class="logo-1">
				<img src="./img/game-developer-logo.png" alt="Game Developer Logo" class="logo-2">
			</a>
			<!-- // Logo -->

			<!-- Mobile Menu -->
			<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-expanded="false"><span><i class="fa fa-bars"></i></span></button>
			<!-- Mobile Menu -->

			<div class="collapse navbar-collapse main-menu" id="navbarSupportedContent">
				<ul class="navbar-nav ml-auto">
					<li class="nav-item"><a class="nav-link" href="./#">Home</a></li>
					<li class="nav-item"><a class="nav-link" href="./#about">About</a></li>
					<li class="nav-item"><a class="nav-link" href="./#resume">Resume</a></li>
					<li class="nav-item"><a class="nav-link" href="./#skills">Skills</a></li>
					<li class="nav-item active"><a class="nav-link" href="./#portfolio">Portfolio</a></li>
					<li class="nav-item"><a class="nav-link" href="./#contact">Contact</a></li>
				</ul>
			</div>
		</div>
	</nav>
	<!-- ====== End Navgition ======  -->
	<!-- HEADER -->
	<div class="port-hero overlay">
		<div class="container">
			<div class="col-md-12">
				<h2>Sun's Out Guns Out</h2>
				<div class="breadcroumb">
					Unity
				</div>
			</div>
		</div>
	</div>
	<!-- END HEADER -->
	<!-- single portfolio section start -->
	<div class="single-portfolio section-padding">
		<div class="container">
			<div class="row">
				<div class="col-md-6">
					<div class="owl-carousel owl-theme">
						<div class="item-portfolio">
							<img src="./img/portfolio/suns-out-guns-out-air-deflect.jpg" alt="Suns Out guns Out air deflect" />
                        </div>
                        <div class="item-portfolio">
                            <img src="./img/portfolio/suns-out-guns-out-grunt-attack.jpg" alt="Suns Out guns Out grunt attack" />
                        </div>
                        <div class="item-portfolio">
                            <img src="./img/portfolio/suns-out-guns-out-lanky-attack.jpg" alt="Suns Out guns Out lanky attack" />
                        </div>
                        <div class="item-portfolio">
                            <img src="./img/portfolio/suns-out-guns-out-perfect-deflection.jpg" alt="Suns Out guns Out perfect deflection" />
                        </div>
                        <div class="item-portfolio">
                            <img src="./img/portfolio/suns-out-guns-out-pickup.jpg" alt="Suns Out guns Out Pickup" />
                        </div>
                        <div class="item-portfolio">
                            <img src="./img/portfolio/suns-out-guns-out-tank.jpg" alt="Suns Out guns Out tank" />
                        </div>
                    </div>
				</div>
				<div class="col-md-6">
					<div class="project-meta-wrapper">
						<h4 class="sub-tit">Project Overview</h4>
						<ul class="single-project-meta">
							<li>
								<i class="fa fa-cube"></i><span>Project Type:</span> Unity 3D Game
							</li>
							<li>
								<i class="fa fa-users"></i><span>Team Size:</span> 5
							</li>
							<li>
								<i class="fa fa-user"></i><span>Role: </span> Gameplay Programmer, VFX & In-Game UI Development
							</li>
							<li>
								<i class="fa fa-desktop"></i><span>Software:</span> Unity, VS Code & Photoshop
							</li>
							<li>
								<i class="fa fa-code"></i><span>Languages:</span> C#
							</li>
							<li>
								<i class="fa fa-link"></i><span>Download link:</span> <a href="https://www.dropbox.com/s/rjfg957tf1ylczr/SOGO.zip?dl=0" target="_blank">Play Game</a>
							</li>
						</ul>
					</div>
				</div>
				<div class="col-md-12">
					<div class="single-project-description">
                        <h4 class="sub-tit">Project Brief</h4>
                        <p>
                            This is a third person "shooter" game where you play as a bodybuilder defending Venice Beach from an alien invasion. The player uses correctly timed poses and flexes to deflect enemy projectiles and eliminate threat.
                        </p>
                        <br>
						<h4 class="sub-tit">Responsibilities/Achievements</h4>
                        <ul>
                            <li>- Program every player mechanic in the game from basic movement, sliding, throwing tanning oil grenades and other objects scattered around the level</li>
                            <li>- Develop the bullet deflection system</li>
                            <li>- Implement camera controls and effects</li>
                            <li>- Develop a Game Event system based on Scriptable Objects to decouple game modules</li>
                            <li>- Create a throwable objects system allowing a better game design</li>
                            <li>- Implement in-game Heads-up Display and Pause UI</li>
                            <li>- Create game's particle effects</li>
                            <li>- Implement player character animation state machine using motion captura animation data</li>
                        </ul>
                        <h4 class="sub-tit">Code Samples</h4>
						<div id="accordion">
							<div class="card">
								<div class="card-header" id="headingOne">
									<h5 class="mb-0">
										<button class="btn btn-link" data-toggle="collapse" data-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
											Bullet Deflector Class
										</button>
									</h5>
								</div>
								<div id="collapseOne" class="collapse" aria-labelledby="headingOne" data-parent="#accordion">
									<div class="card-body">
										<pre><code class="cs">
/*
* Carlos Adan Cortes De la Fuente
* All rights reserved. Copyright (c)
* Email: dev@carlosadan.com
*/
												
[RequireComponent(typeof(CapsuleCollider))]
public abstract class BulletDeflector : MonoBehaviour {
	
	[SerializeField]
	private PlayerState playerState;
	[SerializeField]
	private BooleanVariable disableInput;
	[SerializeField]
	private FloatVariable stamina;
	[SerializeField]
	public EnumVariable bulletTypeToDeflect;
	[SerializeField]
	private FloatVariable mainTrigger;
	[SerializeField]
	private FloatVariable otherTrigger;
	[SerializeField]
	private BooleanVariable active;
	[SerializeField]
	private BooleanVariable otherTriggerActiveState;
	[SerializeField]
	private DeflectorProperties deflectorProperties;
	[SerializeField]
	private GameEvent OnPerfectDeflection;
	[SerializeField]
	private GameEvent OnPoseStarted;
	[SerializeField]
	private GameEvent addScore;
	[SerializeField]
	private float minScoreAddition = 100f;
	[SerializeField]
	private float maxScoreAddition = 250f;


	private Camera mainCamera;
	private CapsuleCollider coll;
	private float maxRadius;
	private bool mainTriggerPreviousState = false;
	private bool otherTriggerPreviousState = false;
	private float startDeflectionTimestamp = 0f;

	private void Awake()
	{
		mainCamera = Camera.main;
		coll = GetComponent&lt;CapsuleCollider>();
		maxRadius = coll.radius;
		playerState.airDeflect = false;
	}

	private void FixedUpdate() {
		if (disableInput.Value || playerState.isPlayerDead) { active.Value = false; return; };
		
		active.Value = 	playerState.sliding == false && 
						playerState.throwingObject == false && 
						playerState.throwingGrenade == false && 
						playerState.meleeing == false && 
						stamina.Value > 0f && 
						((mainTrigger.Value != 0 && otherTrigger.Value == 0) || (mainTrigger.Value != 0 && otherTrigger.Value != 0 && mainTriggerPreviousState)) && 
						otherTriggerActiveState.Value == false && otherTriggerPreviousState == false;
						
		// First frame of deflection
		if (active.Value && mainTriggerPreviousState == false) {
			OnPoseStarted.Raise(this);
			startDeflectionTimestamp = Time.time;
			if (playerState.jumping || playerState.grounded == false) playerState.airDeflect = true;
		}

		// The frame the player let go off the trigger
		if (active.Value == false && mainTriggerPreviousState == true) {
			playerState.airDeflect = false;
		}	

		coll.enabled = active.Value;
		playerState.deflecting = active.Value || otherTriggerActiveState.Value;
		mainTriggerPreviousState = active.Value;
		otherTriggerPreviousState = otherTriggerActiveState.Value;
	}

	private void EvaluateDeflection(Bullet bullet)
	{
		if (Time.time - deflectorProperties.fixedTimeWindow > startDeflectionTimestamp) {
			bullet.DeflectRandomly();
			return;
		}
		
		float distance = Vector3.Magnitude(bullet.transform.position - transform.position);
		if (distance <= deflectorProperties.maxDistanceToPerfectDeflection) {
			distance = Mathf.Clamp(distance, deflectorProperties.minDistanceToPerfectDeflection, deflectorProperties.maxDistanceToPerfectDeflection);
			float multiplier = 1f -distance.Normalize(deflectorProperties.minDistanceToPerfectDeflection, deflectorProperties.maxDistanceToPerfectDeflection);
			bullet.DeflectPerfeclty(multiplier);
			OnPerfectDeflection.Raise(multiplier);
			addScore.Raise(multiplier.Denormalize(minScoreAddition, maxScoreAddition));
		} else {
			bullet.DeflectRandomly();
		}
	}

	private void OnTriggerEnter(Collider other) {
		Bullet bullet = other.gameObject.GetComponent&lt;Bullet>();
		if (bullet != null && bullet.bulletType == bulletTypeToDeflect && bullet.bouncedByPlayer == false) {
			EvaluateDeflection(bullet);
		}
	}
}												
										</code></pre>
									</div>
								</div>
							</div>
							<div class="card">
								<div class="card-header" id="headingTwo">
									<h5 class="mb-0">
										<button class="btn btn-link" data-toggle="collapse" data-target="#collapseTwo" aria-expanded="true" aria-controls="collapseTwo">
											Ballistic Arch Class
										</button>
									</h5>
								</div>
								<div id="collapseTwo" class="collapse" aria-labelledby="headingTwo" data-parent="#accordion">
									<div class="card-body">
										<pre><code class="cs">
/*
* Carlos Adan Cortes De la Fuente
* All rights reserved. Copyright (c)
* Email: dev@carlosadan.com
*/

[RequireComponent(typeof(LineRenderer))]
public class LaunchArch : MonoBehaviour
{

	[SerializeField]
	private GameObject explosionIndicator;
	[SerializeField]
	private BooleanVariable showArch;
	[SerializeField]
	private FloatVariable throwingForce;
	[SerializeField]
	private LayerMask layerMask = -1;

	private GameObject indicatorInstance = null;
	public int maxPositionCount = 1024;

	private LineRenderer lr;

	private void Awake()
	{
		lr = GetComponent&lt;LineRenderer>();
		indicatorInstance = Instantiate(explosionIndicator, transform.position, Quaternion.identity);
		indicatorInstance.SetActive(false);
	}

	private void Update()
	{
		if (showArch.Value == false)
		{
			lr.positionCount = 0;
			if (indicatorInstance.activeInHierarchy) indicatorInstance.SetActive(false);
		}
		else
		{
			DrawArch();
		}
	}

	private void DrawArch()
	{
		// Initialize Values
		float velocity = throwingForce.Value;
		Vector3 currentVelocity = transform.forward * velocity;
		Vector3 currentPosition = transform.position;

		lr.positionCount = maxPositionCount;

		int index = 0;
		bool keepDrawingArch = true;

		while (index < maxPositionCount || keepDrawingArch == false)
		{
			// Draw the current line renderer position
			lr.SetPosition(index, currentPosition);

			// Calculate the next position
			float time = Time.deltaTime;
			Vector3 nextVelocity = currentVelocity + Physics.gravity * time;
			Vector3 nextPosition = currentPosition + nextVelocity * time;

			// Check if it hits something and start
			RaycastHit hit;
			Vector3 nextPositionDirection = nextPosition - currentPosition;
			if (Physics.Raycast(currentPosition, nextPositionDirection, out hit, nextPositionDirection.magnitude, layerMask))
			{
				lr.positionCount = index + 2;
				lr.SetPosition(index + 1, hit.point);
				if (indicatorInstance != null) 
				{
					indicatorInstance.SetActive(true);
					indicatorInstance.transform.forward = hit.normal;
					indicatorInstance.transform.position = hit.point - transform.forward * 0.25f;
				};
				break;
			}
			else
			{
				indicatorInstance.SetActive(false);
			}
			currentPosition = nextPosition;
			currentVelocity = nextVelocity;
			index++;
		}
	}
}
										</code></pre>
									</div>
								</div>
							</div>
							<div class="card">
								<div class="card-header" id="headingThree">
									<h5 class="mb-0">
										<button class="btn btn-link" data-toggle="collapse" data-target="#collapseThree" aria-expanded="true" aria-controls="collapseThree">
											Event System with Scriptable Object & Custom Data
										</button>
									</h5>
								</div>
								<div id="collapseThree" class="collapse" aria-labelledby="headingThree" data-parent="#accordion">
									<div class="card-body">
										<pre><code class="cs">
/*
* Carlos Adan Cortes De la Fuente
* All rights reserved. Copyright (c)
* Email: dev@carlosadan.com
*/

[System.Serializable]
public class Response : UnityEvent&lt;object> {}

public class GameEventListener : MonoBehaviour {

	public GameEvent gameEvent;
	public Response response;

	private void OnEnable() {
		gameEvent.RegisterListener(this);
	}
	
	private void OnDisable() {
		gameEvent.UnregisterListener(this);
	}

	public void OnEventRaised(object data) {
		response.Invoke(data);
	}
	
}

[CreateAssetMenu(fileName="NewGameEvent", menuName="SunsOutGunsOut/GameEvent")]
public class GameEvent : ScriptableObject {

	private List&lt;GameEventListener> listeners = new List&lt;GameEventListener>();

	public void Raise(object data) {
		// Go backwards in case we delete one listener
		for (int i = listeners.Count -1; i >= 0; i--) {
			listeners[i].OnEventRaised(data);
		}
	}

	public void RegisterListener(GameEventListener listener) {
		listeners.Add(listener);
	}
	
	public void UnregisterListener(GameEventListener listener) {
		listeners.Remove(listener);
	}
}
										</code></pre>
									</div>
								</div>
							</div>
							<div class="card">
								<div class="card-header" id="headingFour">
									<h5 class="mb-0">
										<button class="btn btn-link" data-toggle="collapse" data-target="#collapseFour" aria-expanded="true" aria-controls="collapseFour">
											Bullet indicator with Object Pooling
										</button>
									</h5>
								</div>
								<div id="collapseFour" class="collapse" aria-labelledby="headingFour" data-parent="#accordion">
									<div class="card-body">
										<pre><code class="cs">
/*
* Carlos Adan Cortes De la Fuente
* All rights reserved. Copyright (c)
* Email: dev@carlosadan.com
*/
public class BulletIndicatorManager : MonoBehaviour {

	[SerializeField]
	private DeflectorProperties deflectorProperties;
	[SerializeField]
	private BulletIndicatorProperties indicatorProperties;
	[SerializeField]
	private TransformVariable player;
	[SerializeField]
	private BulletTracker blueBulletTracker;
	[SerializeField]
	private BulletTracker redBulletTracker;
	[SerializeField]
	private EnumVariable blueBulletType;
	[SerializeField]
	private EnumVariable redBulletType;
	
	[SerializeField]
	private PoolableObject redIndicatorPrefab;
	[SerializeField]
	private PoolableObject blueIndicatorPrefab;
	[SerializeField]
	private int poolSize = 5;

	private void Awake() {
		blueBulletTracker.bullets = new List&lt;Bullet>();
		redBulletTracker.bullets = new List&lt;Bullet>();
	}

	private void Start() {
		PoolManager.CreatePool(redIndicatorPrefab, poolSize);
		PoolManager.CreatePool(blueIndicatorPrefab, poolSize);
	}

	private void Update() {
		int blueBulletsCount = blueBulletTracker.bullets.Count;
		int redBulletsCount = redBulletTracker.bullets.Count;
		
		if (blueBulletsCount == 0 && redBulletsCount == 0) return;

		if (blueBulletsCount > 0) {
			foreach (Bullet bullet in blueBulletTracker.bullets) {
				if (bullet != null) {
					DetermineVisibility(bullet, blueIndicatorPrefab);
				}
			}
		}

		if (redBulletsCount > 0) {
			foreach (Bullet bullet in redBulletTracker.bullets) {
				DetermineVisibility(bullet, redIndicatorPrefab);
			}
		}
	}

	private void DetermineVisibility(Bullet bullet, PoolableObject pObject) {
		Vector3 direction = bullet.transform.position - player.Value.transform.position;
		direction.y = 0;

		if (direction.magnitude <= indicatorProperties.minDistanceRange) {
			var clone = PoolManager.GetObjectFromPool(pObject);
			BulletIndicator indicator = clone.GetComponent&lt;BulletIndicator>();
			indicator.transform.position = transform.position;
			indicator.transform.forward = transform.up;
			indicator.SetScale(direction.magnitude);
			indicator.gameObject.SetActive(true);
		}
	}

	private void OnDrawGizmos()
	{
		Gizmos.color = Color.white;
        Gizmos.DrawLine(transform.position, transform.position + transform.forward * deflectorProperties.maxDistanceToPerfectDeflection);
		Gizmos.color = Color.red;
        Gizmos.DrawLine(transform.position, transform.position + transform.forward * deflectorProperties.minDistanceToPerfectDeflection);
	}
}
										</code></pre>
									</div>
								</div>
							</div>
						</div>
					</div>
					<div class="single-project-link">
						<a href="./#portfolio" class="project-link prev-project"><i class="fa fa-angle-left"> back to projects</i></a>
					</div>
				</div>
			</div>
		</div>
	</div>
	<!-- single portfolio section end -->
	<footer>
		<div class="container">
			<div class="row">
				<h3>Contact Details</h3>
				<ul class="footer-info">
					<li><i class="fa fa-phone"></i>+52 1 722-4043176</li>
					<li><i class="fa fa-envelope"></i>dev@carlosadan.com<li>
				</ul>
				<div class="social-icon">
					<a href="https://www.linkedin.com/in/carlos-adan-cortes-de-la-fuente-20777356/" target="_blank"><span><i class="fa fa-linkedin" aria-hidden="true"></i></span></a>
					<a href="https://github.com/krlozadan" target="_blank"><span><i class="fa fa-github" aria-hidden="true"></i></span></a>
					<a href="https://twitter.com/krlozadan" target="_blank"><span><i class="fa fa-twitter" aria-hidden="true"></i></span></a>
				</div>
				<img src="./img/game-developer-logo.png" alt="Game Developer Logo">
			</div>
			<!-- ./ Row -->
		</div>
		<!-- ./ Container -->
		<div class="rights">
			<p>©2018 Carlos Adan. All Rights Reserved.</p>
		</div>
	</footer>
	<!-- ======./ Footer ======  -->
	<!-- Optional JavaScript -->
	<script src="./js/jquery-3.1.1.min.js"></script>
	<script src="./js/Migrate.js"></script>
	<script src="./js/bootstrap.min.js"></script>
	<!-- scrollIt js -->
	<script src="./js/scrollIt.min.js"></script>
	<!-- owl carousel js -->
	<script src="./js/owl.carousel.min.js"></script>
	<!-- jquery.counterup.min js -->
	<script src="./js/jquery.counterup.min.js"></script>
	<!-- typed -->
	<script src="./js/typed.js"></script>
	<!-- magnific-popup -->
	<script src="./js/jquery.magnific-popup.min.js"></script>
	<!-- isotope.pkgd.min js -->
	<script src="./js/isotope.pkgd.min.js"></script>
	<!-- jquery.waypoints.min js -->
	<script src="./js/jquery.waypoints.min.js"></script>
	<script src="./js/wow.js"></script>
	<!-- jquery barfiller js -->
	<script src="./js/jquery.barfiller.js"></script>
	<!-- jquery matchHeight -->
	<script src="./js/jquery.matchHeight-min.js"></script>
	<script src="./js/background-effect.js"></script>
	<!-- validator js -->
	<script src="./js/validator.js"></script>
	<!-- ====== gmap3 js ======= -->
	<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDJ_mGhah8EApmFiXYYBsdBuygviP2M2EE"></script>
	<script src="./js/gmap3.min.js"></script>
	<!-- ====== Highlight JS ======= -->
	<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.13.1/highlight.min.js"></script>
	<!-- custom JavaScript -->
	<script src="./js/custom.js"></script>
	<script>hljs.initHighlightingOnLoad();</script>
</body>

</html>